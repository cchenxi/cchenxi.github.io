<!doctype html><html class=no-js lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>GC日志解读 - 陈曦的技术博客</title>
<script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script>
<meta name=description content>
<meta property="og:title" content="GC日志解读">
<meta property="og:description" content="为深入学习GC（Garbage Collection，垃圾回收），本文将使用一段测试代码来测试不同的GC策略下的执行情况，并对输出的GC日志做简要分析。
1. 测试环境 1.1. 操作系统及jdk版本 ➜ 01jvm git:(main) ✗ java -version java version &#34;1.8.0_131&#34; Java(TM) SE Runtime Environment (build 1.8.0_131-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode) 1.2. 测试代码  测试代码来源： https://github.com/JavaCourse00/JavaCourseCodes/blob/main/01jvm/GCLogAnalysis.java
 import java.util.Random; import java.util.concurrent.TimeUnit; import java.util.concurrent.atomic.LongAdder; /* 演示GC日志生成与解读 */ public class GCLogAnalysis { private static Random random = new Random(); public static void main(String[] args) { // 当前毫秒时间戳  long startMillis = System.currentTimeMillis(); // 持续运行毫秒数; 可根据需要进行修改  long timeoutMillis = TimeUnit.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://cchenxi.github.io/posts/gc%E6%97%A5%E5%BF%97%E8%A7%A3%E8%AF%BB/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-06-05T11:04:00+08:00">
<meta property="article:modified_time" content="2021-06-05T11:04:00+08:00">
<meta itemprop=name content="GC日志解读">
<meta itemprop=description content="为深入学习GC（Garbage Collection，垃圾回收），本文将使用一段测试代码来测试不同的GC策略下的执行情况，并对输出的GC日志做简要分析。
1. 测试环境 1.1. 操作系统及jdk版本 ➜ 01jvm git:(main) ✗ java -version java version &#34;1.8.0_131&#34; Java(TM) SE Runtime Environment (build 1.8.0_131-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode) 1.2. 测试代码  测试代码来源： https://github.com/JavaCourse00/JavaCourseCodes/blob/main/01jvm/GCLogAnalysis.java
 import java.util.Random; import java.util.concurrent.TimeUnit; import java.util.concurrent.atomic.LongAdder; /* 演示GC日志生成与解读 */ public class GCLogAnalysis { private static Random random = new Random(); public static void main(String[] args) { // 当前毫秒时间戳  long startMillis = System.currentTimeMillis(); // 持续运行毫秒数; 可根据需要进行修改  long timeoutMillis = TimeUnit."><meta itemprop=datePublished content="2021-06-05T11:04:00+08:00">
<meta itemprop=dateModified content="2021-06-05T11:04:00+08:00">
<meta itemprop=wordCount content="5870">
<meta itemprop=keywords content="Java,GC,JVM,">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="GC日志解读">
<meta name=twitter:description content="为深入学习GC（Garbage Collection，垃圾回收），本文将使用一段测试代码来测试不同的GC策略下的执行情况，并对输出的GC日志做简要分析。
1. 测试环境 1.1. 操作系统及jdk版本 ➜ 01jvm git:(main) ✗ java -version java version &#34;1.8.0_131&#34; Java(TM) SE Runtime Environment (build 1.8.0_131-b11) Java HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode) 1.2. 测试代码  测试代码来源： https://github.com/JavaCourse00/JavaCourseCodes/blob/main/01jvm/GCLogAnalysis.java
 import java.util.Random; import java.util.concurrent.TimeUnit; import java.util.concurrent.atomic.LongAdder; /* 演示GC日志生成与解读 */ public class GCLogAnalysis { private static Random random = new Random(); public static void main(String[] args) { // 当前毫秒时间戳  long startMillis = System.currentTimeMillis(); // 持续运行毫秒数; 可根据需要进行修改  long timeoutMillis = TimeUnit.">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=dns-prefetch href=//fonts.gstatic.com>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
<link rel=stylesheet href=/css/style.css>
<link rel="shortcut icon" href=/favicon.ico>
</head>
<body class=body>
<div class="container container--outer">
<header class=header>
<div class="container header__container">
<div class="logo logo--mixed">
<a class=logo__link href=/ title=陈曦的技术博客 rel=home>
<div class="logo__item logo__imagebox">
<img class=logo__img src=/image/WechatIMG2.jpeg>
</div><div class="logo__item logo__text">
<div class=logo__title>陈曦的技术博客</div>
</div>
</a>
</div>
<div class=divider></div>
</div>
</header>
<div class="wrapper flex">
<div class=primary>
<main class=main role=main>
<article class=post>
<header class=post__header>
<h1 class=post__title>GC日志解读</h1>
<div class="post__meta meta"><div class="meta__item-author meta__item">
<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>陈曦</span>
</div>
<div class="meta__item-datetime meta__item">
<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2021-06-05T11:04:00+08:00>2021-06-05</time></div></div>
</header>
<div class="post__toc toc">
<div class=toc__title>Page content</div>
<div class=toc__menu>
<nav id=TableOfContents>
<ul>
<li><a href=#1-测试环境>1. 测试环境</a>
<ul>
<li><a href=#11-操作系统及jdk版本>1.1. 操作系统及jdk版本</a></li>
<li><a href=#12-测试代码>1.2. 测试代码</a></li>
</ul>
</li>
<li><a href=#2-演示不同gc策略>2. 演示不同GC策略</a>
<ul>
<li><a href=#21-并行gc的演示>2.1 并行GC的演示</a></li>
<li><a href=#22-串行gc的演示>2.2 串行GC的演示</a></li>
<li><a href=#23-cms-gc的演示>2.3 CMS GC的演示</a></li>
<li><a href=#24-g1-gc的演示>2.4 G1 GC的演示</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div><div class="content post__content clearfix">
<p>为深入学习GC（Garbage Collection，垃圾回收），本文将使用一段测试代码来测试不同的GC策略下的执行情况，并对输出的GC日志做简要分析。</p>
<h2 id=1-测试环境>1. 测试环境</h2>
<h3 id=11-操作系统及jdk版本>1.1. 操作系统及jdk版本</h3>
<p><img src=/image/20210605/os-info.jpg alt=操作系统信息></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>➜  01jvm git:<span style=color:#f92672>(</span>main<span style=color:#f92672>)</span> ✗ java -version
java version <span style=color:#e6db74>&#34;1.8.0_131&#34;</span>
Java<span style=color:#f92672>(</span>TM<span style=color:#f92672>)</span> SE Runtime Environment <span style=color:#f92672>(</span>build 1.8.0_131-b11<span style=color:#f92672>)</span>
Java HotSpot<span style=color:#f92672>(</span>TM<span style=color:#f92672>)</span> 64-Bit Server VM <span style=color:#f92672>(</span>build 25.131-b11, mixed mode<span style=color:#f92672>)</span>
</code></pre></div><h3 id=12-测试代码>1.2. 测试代码</h3>
<blockquote>
<p>测试代码来源： <a href=https://github.com/JavaCourse00/JavaCourseCodes/blob/main/01jvm/GCLogAnalysis.java>https://github.com/JavaCourse00/JavaCourseCodes/blob/main/01jvm/GCLogAnalysis.java</a></p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#f92672>import</span> java.util.Random<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> java.util.concurrent.TimeUnit<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> java.util.concurrent.atomic.LongAdder<span style=color:#f92672>;</span>
<span style=color:#75715e>/*
</span><span style=color:#75715e>演示GC日志生成与解读
</span><span style=color:#75715e>*/</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GCLogAnalysis</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Random random <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Random<span style=color:#f92672>();</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#75715e>// 当前毫秒时间戳
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>long</span> startMillis <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>currentTimeMillis</span><span style=color:#f92672>();</span>
        <span style=color:#75715e>// 持续运行毫秒数; 可根据需要进行修改
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>long</span> timeoutMillis <span style=color:#f92672>=</span> TimeUnit<span style=color:#f92672>.</span><span style=color:#a6e22e>SECONDS</span><span style=color:#f92672>.</span><span style=color:#a6e22e>toMillis</span><span style=color:#f92672>(</span>1<span style=color:#f92672>);</span>
        <span style=color:#75715e>// 结束时间戳
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>long</span> endMillis <span style=color:#f92672>=</span> startMillis <span style=color:#f92672>+</span> timeoutMillis<span style=color:#f92672>;</span>
        LongAdder counter <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LongAdder<span style=color:#f92672>();</span>
        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;正在执行...&#34;</span><span style=color:#f92672>);</span>
        <span style=color:#75715e>// 缓存一部分对象; 进入老年代
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span> cacheSize <span style=color:#f92672>=</span> 2000<span style=color:#f92672>;</span>
        Object<span style=color:#f92672>[]</span> cachedGarbage <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[</span>cacheSize<span style=color:#f92672>];</span>
        <span style=color:#75715e>// 在此时间范围内,持续循环
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>currentTimeMillis</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> endMillis<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#75715e>// 生成垃圾对象
</span><span style=color:#75715e></span>            Object garbage <span style=color:#f92672>=</span> generateGarbage<span style=color:#f92672>(</span>100<span style=color:#f92672>*</span>1024<span style=color:#f92672>);</span>
            counter<span style=color:#f92672>.</span><span style=color:#a6e22e>increment</span><span style=color:#f92672>();</span>
            <span style=color:#66d9ef>int</span> randomIndex <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>(</span>2 <span style=color:#f92672>*</span> cacheSize<span style=color:#f92672>);</span>
            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>randomIndex <span style=color:#f92672>&lt;</span> cacheSize<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                cachedGarbage<span style=color:#f92672>[</span>randomIndex<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> garbage<span style=color:#f92672>;</span>
            <span style=color:#f92672>}</span>
        <span style=color:#f92672>}</span>
        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;执行结束!共生成对象次数:&#34;</span> <span style=color:#f92672>+</span> counter<span style=color:#f92672>.</span><span style=color:#a6e22e>longValue</span><span style=color:#f92672>());</span>
    <span style=color:#f92672>}</span>

    <span style=color:#75715e>// 生成对象
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Object <span style=color:#a6e22e>generateGarbage</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> max<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>int</span> randomSize <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span><span style=color:#a6e22e>nextInt</span><span style=color:#f92672>(</span>max<span style=color:#f92672>);</span>
        <span style=color:#66d9ef>int</span> type <span style=color:#f92672>=</span> randomSize <span style=color:#f92672>%</span> 4<span style=color:#f92672>;</span>
        Object result <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
        <span style=color:#66d9ef>switch</span> <span style=color:#f92672>(</span>type<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>case</span> 0<span style=color:#f92672>:</span>
                result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>randomSize<span style=color:#f92672>];</span>
                <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
            <span style=color:#66d9ef>case</span> 1<span style=color:#f92672>:</span>
                result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>randomSize<span style=color:#f92672>];</span>
                <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
            <span style=color:#66d9ef>case</span> 2<span style=color:#f92672>:</span>
                result <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span><span style=color:#f92672>[</span>randomSize<span style=color:#f92672>];</span>
                <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
            <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
                StringBuilder builder <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>();</span>
                String randomString <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;randomString-Anything&#34;</span><span style=color:#f92672>;</span>
                <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>builder<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> randomSize<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                    builder<span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>randomString<span style=color:#f92672>);</span>
                    builder<span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>max<span style=color:#f92672>);</span>
                    builder<span style=color:#f92672>.</span><span style=color:#a6e22e>append</span><span style=color:#f92672>(</span>randomSize<span style=color:#f92672>);</span>
                <span style=color:#f92672>}</span>
                result <span style=color:#f92672>=</span> builder<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
                <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>return</span> result<span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>编译测试代码</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>javac GCLogAnalysis.java
</code></pre></div><p>在控制台执行如下命令，打印GC信息</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+PrintGCDetails GCLogAnalysis
</code></pre></div><pre tabindex=0><code class=language-log data-lang=log>正在执行...
[GC (Allocation Failure) [PSYoungGen: 65252K-&gt;10747K(76288K)] 65252K-&gt;19386K(251392K), 0.0064988 secs] [Times: user=0.02 sys=0.02, real=0.01 secs]
[GC (Allocation Failure) [PSYoungGen: 76210K-&gt;10738K(141824K)] 84850K-&gt;40942K(316928K), 0.0119404 secs] [Times: user=0.02 sys=0.04, real=0.01 secs]
[GC (Allocation Failure) [PSYoungGen: 141810K-&gt;10742K(141824K)] 172014K-&gt;85396K(316928K), 0.0169297 secs] [Times: user=0.03 sys=0.08, real=0.02 secs]
[GC (Allocation Failure) [PSYoungGen: 141629K-&gt;10744K(272896K)] 216283K-&gt;130177K(448000K), 0.0191197 secs] [Times: user=0.03 sys=0.09, real=0.02 secs]
[Full GC (Ergonomics) [PSYoungGen: 10744K-&gt;0K(272896K)] [ParOldGen: 119433K-&gt;119191K(258560K)] 130177K-&gt;119191K(531456K), [Metaspace: 2544K-&gt;2544K(1056768K)], 0.0200658 secs] [Times: user=0.10 sys=0.00, real=0.02 secs]
[GC (Allocation Failure) [PSYoungGen: 262144K-&gt;10751K(272896K)] 381335K-&gt;193115K(531456K), 0.0451714 secs] [Times: user=0.04 sys=0.09, real=0.04 secs]
[Full GC (Ergonomics) [PSYoungGen: 10751K-&gt;0K(272896K)] [ParOldGen: 182363K-&gt;166011K(343040K)] 193115K-&gt;166011K(615936K), [Metaspace: 2544K-&gt;2544K(1056768K)], 0.0215776 secs] [Times: user=0.11 sys=0.00, real=0.02 secs]
[GC (Allocation Failure) [PSYoungGen: 262144K-&gt;84521K(546304K)] 428155K-&gt;250532K(889344K), 0.0364856 secs] [Times: user=0.05 sys=0.10, real=0.04 secs]
[GC (Allocation Failure) [PSYoungGen: 542761K-&gt;102396K(560640K)] 708772K-&gt;350584K(903680K), 0.1000140 secs] [Times: user=0.10 sys=0.22, real=0.10 secs]
[GC (Allocation Failure) [PSYoungGen: 560636K-&gt;161780K(923648K)] 808824K-&gt;443025K(1266688K), 0.1457590 secs] [Times: user=0.10 sys=0.26, real=0.15 secs]
[Full GC (Ergonomics) [PSYoungGen: 161780K-&gt;0K(923648K)] [ParOldGen: 281244K-&gt;304039K(501760K)] 443025K-&gt;304039K(1425408K), [Metaspace: 2544K-&gt;2544K(1056768K)], 0.0563595 secs] [Times: user=0.19 sys=0.03, real=0.05 secs]
执行结束!共生成对象次数:6870
Heap
 PSYoungGen      total 923648K, used 30397K [0x000000076ab00000, 0x00000007b5f00000, 0x00000007c0000000)
  eden space 761856K, 3% used [0x000000076ab00000,0x000000076c8af788,0x0000000799300000)
  from space 161792K, 0% used [0x00000007a5b00000,0x00000007a5b00000,0x00000007af900000)
  to   space 204800K, 0% used [0x0000000799300000,0x0000000799300000,0x00000007a5b00000)
 ParOldGen       total 501760K, used 304039K [0x00000006c0000000, 0x00000006dea00000, 0x000000076ab00000)
  object space 501760K, 60% used [0x00000006c0000000,0x00000006d28e9dd8,0x00000006dea00000)
 Metaspace       used 2551K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 276K, capacity 386K, committed 512K, reserved 1048576K
</code></pre><p>还可以使用以下命令，将GC信息输出到日志文件中，同时打印GC的详细信息和时间戳</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -Xloggc:gc.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps GCLogAnalysis
</code></pre></div><h2 id=2-演示不同gc策略>2. 演示不同GC策略</h2>
<h3 id=21-并行gc的演示>2.1 并行GC的演示</h3>
<h4 id=211-默认不配置堆内存参数>2.1.1 默认不配置堆内存参数</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># input</span>
java -XX:+PrintGCDetails -XX:+PrintGCDateStamps GCLogAnalysis

<span style=color:#75715e># output</span>
正在执行...
2020-10-25T20:09:45.532-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 65536K-&gt;10730K<span style=color:#f92672>(</span>76288K<span style=color:#f92672>)]</span> 65536K-&gt;22808K<span style=color:#f92672>(</span>251392K<span style=color:#f92672>)</span>, 0.0094137 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.560-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 76266K-&gt;10746K<span style=color:#f92672>(</span>141824K<span style=color:#f92672>)]</span> 88344K-&gt;41760K<span style=color:#f92672>(</span>316928K<span style=color:#f92672>)</span>, 0.0207021 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.09, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.629-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 141818K-&gt;10742K<span style=color:#f92672>(</span>141824K<span style=color:#f92672>)]</span> 172832K-&gt;84807K<span style=color:#f92672>(</span>316928K<span style=color:#f92672>)</span>, 0.0276267 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.14, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.690-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 141814K-&gt;10742K<span style=color:#f92672>(</span>272896K<span style=color:#f92672>)]</span> 215879K-&gt;129048K<span style=color:#f92672>(</span>448000K<span style=color:#f92672>)</span>, 0.0265651 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.14, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.717-0800: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 10742K-&gt;0K<span style=color:#f92672>(</span>272896K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 118306K-&gt;117582K<span style=color:#f92672>(</span>252928K<span style=color:#f92672>)]</span> 129048K-&gt;117582K<span style=color:#f92672>(</span>525824K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0275435 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.15 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.848-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 262144K-&gt;10746K<span style=color:#f92672>(</span>272896K<span style=color:#f92672>)]</span> 379726K-&gt;196735K<span style=color:#f92672>(</span>525824K<span style=color:#f92672>)</span>, 0.0408603 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.20, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.889-0800: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 10746K-&gt;0K<span style=color:#f92672>(</span>272896K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 185988K-&gt;170435K<span style=color:#f92672>(</span>351232K<span style=color:#f92672>)]</span> 196735K-&gt;170435K<span style=color:#f92672>(</span>624128K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0375020 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.22 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:45.982-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 262144K-&gt;84652K<span style=color:#f92672>(</span>532480K<span style=color:#f92672>)]</span> 432579K-&gt;255087K<span style=color:#f92672>(</span>883712K<span style=color:#f92672>)</span>, 0.0448442 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.22, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:46.169-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 528044K-&gt;102900K<span style=color:#f92672>(</span>546304K<span style=color:#f92672>)]</span> 698479K-&gt;347045K<span style=color:#f92672>(</span>897536K<span style=color:#f92672>)</span>, 0.0791139 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.10 sys<span style=color:#f92672>=</span>0.39, real<span style=color:#f92672>=</span>0.08 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:46.326-0800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 546292K-&gt;157688K<span style=color:#f92672>(</span>867328K<span style=color:#f92672>)]</span> 790437K-&gt;437489K<span style=color:#f92672>(</span>1218560K<span style=color:#f92672>)</span>, 0.0928147 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.10 sys<span style=color:#f92672>=</span>0.49, real<span style=color:#f92672>=</span>0.09 secs<span style=color:#f92672>]</span>
2020-10-25T20:09:46.419-0800: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 157688K-&gt;0K<span style=color:#f92672>(</span>867328K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 279800K-&gt;293211K<span style=color:#f92672>(</span>494080K<span style=color:#f92672>)]</span> 437489K-&gt;293211K<span style=color:#f92672>(</span>1361408K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0528697 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.29 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:7171
Heap
 PSYoungGen      total 867328K, used 86222K <span style=color:#f92672>[</span>0x000000076ab00000, 0x00000007b1f00000, 0x00000007c0000000<span style=color:#f92672>)</span>
  eden space 709632K, 12% used <span style=color:#f92672>[</span>0x000000076ab00000,0x000000076ff33908,0x0000000796000000<span style=color:#f92672>)</span>
  from space 157696K, 0% used <span style=color:#f92672>[</span>0x00000007a2400000,0x00000007a2400000,0x00000007abe00000<span style=color:#f92672>)</span>
  to   space 200704K, 0% used <span style=color:#f92672>[</span>0x0000000796000000,0x0000000796000000,0x00000007a2400000<span style=color:#f92672>)</span>
 ParOldGen       total 494080K, used 293211K <span style=color:#f92672>[</span>0x00000006c0000000, 0x00000006de280000, 0x000000076ab00000<span style=color:#f92672>)</span>
  object space 494080K, 59% used <span style=color:#f92672>[</span>0x00000006c0000000,0x00000006d1e56fa8,0x00000006de280000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>不指定垃圾收集器 默认使用的是并行GC</p>
<p>以上GC日志显示，程序执行期间共发生11次GC 其中包含3次Full GC</p>
<p>第一次Young GC，[GC (Allocation Failure) [PSYoungGen: 65536K->10730K(76288K)] 65536K->22808K(251392K), 0.0094137 secs] [Times: user=0.02 sys=0.04, real=0.01 secs]</p>
<p>Young区堆内存使用 65536K->10730K(76288K)，减少54806K。</p>
<p>整个堆内存使用 65536K->22808K(251392K)，减少42728K。</p>
<p>初始的堆内存使用量相同，是因为一次GC也没有发生时，Old区尚未使用。</p>
<p>Young区的减少 大于 整个堆区的减少，因为有可能有约十几m的对象进入了Old区。Young GC发生时，一部分对象被晋升到了Old区，一部分对象被复制到了未使用的Survivor区。</p>
<p>经过4次Young GC之后，堆内存的使用已经较大，程序继续执行就触发了一次Full GC</p>
<p>[Full GC (Ergonomics) [PSYoungGen: 10742K->0K(272896K)] [ParOldGen: 118306K->117582K(252928K)] 129048K->117582K(525824K), [Metaspace: 2689K->2689K(1056768K)], 0.0275435 secs] [Times: user=0.15 sys=0.01, real=0.03 secs]</p>
<p>Full GC发生时</p>
<p>Young区10742K->0K(272896K)</p>
<p>Old区118306K->117582K(252928K) ，Old区变化较少</p>
<p>整个堆129048K->117582K(525824K)</p>
<p>Metaspace 无变化</p>
<p>在不配置堆内存参数的情况下 默认使用的堆内存大小是物理内存的1/4，本机配置为8核16G 所以此处默认的堆内存大小为4G，查看GC日志之后发现执行的命令如下：</p>
<p>CommandLine flags: -XX:InitialHeapSize=268435456 -XX:MaxHeapSize=4294967296 -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseParallelGC</p>
<p>只是Xmx的配置是4G Xms的配置为256m</p>
<h4 id=212-配置512m堆内存>2.1.2 配置512m堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseParallelGC -Xms512m -Xmx512m -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T21:48:09.230-0800: 0.168: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 131584K-&gt;21496K<span style=color:#f92672>(</span>153088K<span style=color:#f92672>)]</span> 131584K-&gt;50443K<span style=color:#f92672>(</span>502784K<span style=color:#f92672>)</span>, 0.0223842 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.11, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.296-0800: 0.234: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 153080K-&gt;21500K<span style=color:#f92672>(</span>153088K<span style=color:#f92672>)]</span> 182027K-&gt;92156K<span style=color:#f92672>(</span>502784K<span style=color:#f92672>)</span>, 0.0301401 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.15, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.351-0800: 0.289: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 153084K-&gt;21492K<span style=color:#f92672>(</span>153088K<span style=color:#f92672>)]</span> 223740K-&gt;136536K<span style=color:#f92672>(</span>502784K<span style=color:#f92672>)</span>, 0.0361967 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.09 sys<span style=color:#f92672>=</span>0.14, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.411-0800: 0.349: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 152653K-&gt;21493K<span style=color:#f92672>(</span>153088K<span style=color:#f92672>)]</span> 267697K-&gt;176705K<span style=color:#f92672>(</span>502784K<span style=color:#f92672>)</span>, 0.0263466 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.11, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.466-0800: 0.404: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 153077K-&gt;21490K<span style=color:#f92672>(</span>153088K<span style=color:#f92672>)]</span> 308289K-&gt;219164K<span style=color:#f92672>(</span>502784K<span style=color:#f92672>)</span>, 0.0333237 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.14, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.530-0800: 0.469: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 153074K-&gt;21494K<span style=color:#f92672>(</span>80384K<span style=color:#f92672>)]</span> 350748K-&gt;257036K<span style=color:#f92672>(</span>430080K<span style=color:#f92672>)</span>, 0.0261909 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.09, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.571-0800: 0.510: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 79983K-&gt;36297K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 315525K-&gt;275163K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0065826 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.594-0800: 0.532: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 95177K-&gt;48333K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 334043K-&gt;294781K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0154817 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.08 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.631-0800: 0.570: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 107179K-&gt;57284K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 353627K-&gt;312167K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0217891 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.10 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.671-0800: 0.610: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 116164K-&gt;37958K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 371047K-&gt;328937K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0355582 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.13, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.707-0800: 0.645: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 37958K-&gt;0K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 290979K-&gt;229237K<span style=color:#f92672>(</span>349696K<span style=color:#f92672>)]</span> 328937K-&gt;229237K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0638496 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.37 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.782-0800: 0.720: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 58880K-&gt;15657K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 288117K-&gt;244895K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0021288 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.794-0800: 0.732: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 74537K-&gt;19089K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 303775K-&gt;263160K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0037648 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.808-0800: 0.746: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 77863K-&gt;21565K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 321934K-&gt;284247K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0138577 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.843-0800: 0.781: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 80028K-&gt;22805K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 342710K-&gt;305201K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0122709 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.877-0800: 0.815: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 81685K-&gt;18378K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 364081K-&gt;323158K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0197694 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.897-0800: 0.835: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 18378K-&gt;0K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 304780K-&gt;263770K<span style=color:#f92672>(</span>349696K<span style=color:#f92672>)]</span> 323158K-&gt;263770K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0698176 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.40 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:09.989-0800: 0.927: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 58880K-&gt;22461K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 322650K-&gt;286232K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0070142 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:10.018-0800: 0.956: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 81323K-&gt;20438K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 345094K-&gt;304973K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0113317 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:10.050-0800: 0.988: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 79260K-&gt;22582K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 363796K-&gt;326898K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0137229 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.08 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:10.085-0800: 1.023: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 81462K-&gt;21499K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> 385778K-&gt;348006K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, 0.0248649 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.08, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T21:48:10.110-0800: 1.048: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 21499K-&gt;0K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 326506K-&gt;285936K<span style=color:#f92672>(</span>349696K<span style=color:#f92672>)]</span> 348006K-&gt;285936K<span style=color:#f92672>(</span>466432K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0695991 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.42 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:5942
Heap
 PSYoungGen      total 116736K, used 2476K <span style=color:#f92672>[</span>0x00000007b5580000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
  eden space 58880K, 4% used <span style=color:#f92672>[</span>0x00000007b5580000,0x00000007b57eb1f8,0x00000007b8f00000<span style=color:#f92672>)</span>
  from space 57856K, 0% used <span style=color:#f92672>[</span>0x00000007b8f00000,0x00000007b8f00000,0x00000007bc780000<span style=color:#f92672>)</span>
  to   space 57856K, 0% used <span style=color:#f92672>[</span>0x00000007bc780000,0x00000007bc780000,0x00000007c0000000<span style=color:#f92672>)</span>
 ParOldGen       total 349696K, used 285936K <span style=color:#f92672>[</span>0x00000007a0000000, 0x00000007b5580000, 0x00000007b5580000<span style=color:#f92672>)</span>
  object space 349696K, 81% used <span style=color:#f92672>[</span>0x00000007a0000000,0x00000007b173c3c0,0x00000007b5580000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><blockquote>
<p>2020-10-27T21:48:09.230-0800: 0.168: [GC (Allocation Failure) [PSYoungGen: 131584K->21496K(153088K)] 131584K->50443K(502784K), 0.0223842 secs] [Times: user=0.03 sys=0.11, real=0.02 secs]</p>
</blockquote>
<p>第一次Young GC</p>
<p>年轻代使用的堆内存从131584K 降低到 21496K ，减少110088K，Young区的容量为153088K</p>
<p>堆内存使用从151584K 降低至 50443K，减少101141K ，整个堆容量为502784K</p>
<p>共有8947K大小的对象从年轻代中晋升到老年代。</p>
<p>GC耗时约22ms</p>
<blockquote>
<p>2020-10-27T21:48:09.707-0800: 0.645: [Full GC (Ergonomics) [PSYoungGen: 37958K->0K(116736K)] [ParOldGen: 290979K->229237K(349696K)] 328937K->229237K(466432K), [Metaspace: 2689K->2689K(1056768K)], 0.0638496 secs] [Times: user=0.37 sys=0.02, real=0.07 secs]</p>
</blockquote>
<p>第一次Full GC</p>
<p>年轻代使用的堆内存从37958K减少到0</p>
<p>老年代使用的堆内存从290979K 减少到 229237K 销毁掉61742K大小的对象</p>
<p>整个堆内存的使用从328937K 减少到 229237K</p>
<p>元数据区没有变化</p>
<p>GC耗时约64ms 应用程序暂停70ms</p>
<h4 id=213-使用2g堆内存>2.1.3 使用2g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseParallelGC -Xms2g -Xmx2g -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T22:03:40.498-0800: 0.375: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 524800K-&gt;87035K<span style=color:#f92672>(</span>611840K<span style=color:#f92672>)]</span> 524800K-&gt;141649K<span style=color:#f92672>(</span>2010112K<span style=color:#f92672>)</span>, 0.0619776 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.33, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-27T22:03:40.660-0800: 0.537: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 611835K-&gt;87030K<span style=color:#f92672>(</span>611840K<span style=color:#f92672>)]</span> 666449K-&gt;258132K<span style=color:#f92672>(</span>2010112K<span style=color:#f92672>)</span>, 0.0911996 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.11 sys<span style=color:#f92672>=</span>0.48, real<span style=color:#f92672>=</span>0.09 secs<span style=color:#f92672>]</span>
2020-10-27T22:03:40.840-0800: 0.717: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 611830K-&gt;87032K<span style=color:#f92672>(</span>611840K<span style=color:#f92672>)]</span> 782932K-&gt;373115K<span style=color:#f92672>(</span>2010112K<span style=color:#f92672>)</span>, 0.0814008 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.23 sys<span style=color:#f92672>=</span>0.29, real<span style=color:#f92672>=</span>0.08 secs<span style=color:#f92672>]</span>
2020-10-27T22:03:41.021-0800: 0.898: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 611832K-&gt;87032K<span style=color:#f92672>(</span>611840K<span style=color:#f92672>)]</span> 897915K-&gt;489779K<span style=color:#f92672>(</span>2010112K<span style=color:#f92672>)</span>, 0.0649686 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.15 sys<span style=color:#f92672>=</span>0.28, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-27T22:03:41.175-0800: 1.052: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 611832K-&gt;87025K<span style=color:#f92672>(</span>611840K<span style=color:#f92672>)]</span> 1014579K-&gt;595189K<span style=color:#f92672>(</span>2010112K<span style=color:#f92672>)</span>, 0.0598866 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.14 sys<span style=color:#f92672>=</span>0.25, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:9771
Heap
 PSYoungGen      total 611840K, used 108298K <span style=color:#f92672>[</span>0x0000000795580000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
  eden space 524800K, 4% used <span style=color:#f92672>[</span>0x0000000795580000,0x0000000796a46228,0x00000007b5600000<span style=color:#f92672>)</span>
  from space 87040K, 99% used <span style=color:#f92672>[</span>0x00000007b5600000,0x00000007baafc668,0x00000007bab00000<span style=color:#f92672>)</span>
  to   space 87040K, 0% used <span style=color:#f92672>[</span>0x00000007bab00000,0x00000007bab00000,0x00000007c0000000<span style=color:#f92672>)</span>
 ParOldGen       total 1398272K, used 508163K <span style=color:#f92672>[</span>0x0000000740000000, 0x0000000795580000, 0x0000000795580000<span style=color:#f92672>)</span>
  object space 1398272K, 36% used <span style=color:#f92672>[</span>0x0000000740000000,0x000000075f040e58,0x0000000795580000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>可以观察到未发生Full GC，GC之后老年代的使用率只有36%</p>
<p>创建的对象数也随着堆内存的增大而增多。</p>
<h4 id=214-使用128m堆内存>2.1.4 使用128m堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseParallelGC -Xms128m -Xmx128m -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T22:09:29.946-0800: 0.112: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 33280K-&gt;5098K<span style=color:#f92672>(</span>38400K<span style=color:#f92672>)]</span> 33280K-&gt;13540K<span style=color:#f92672>(</span>125952K<span style=color:#f92672>)</span>, 0.0055672 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:29.960-0800: 0.126: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 37794K-&gt;5110K<span style=color:#f92672>(</span>38400K<span style=color:#f92672>)]</span> 46236K-&gt;25958K<span style=color:#f92672>(</span>125952K<span style=color:#f92672>)</span>, 0.0095484 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.05, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:29.979-0800: 0.145: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 38390K-&gt;5103K<span style=color:#f92672>(</span>38400K<span style=color:#f92672>)]</span> 59238K-&gt;36124K<span style=color:#f92672>(</span>125952K<span style=color:#f92672>)</span>, 0.0071565 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:29.997-0800: 0.162: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 38140K-&gt;5117K<span style=color:#f92672>(</span>38400K<span style=color:#f92672>)]</span> 69161K-&gt;48383K<span style=color:#f92672>(</span>125952K<span style=color:#f92672>)</span>, 0.0092709 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.018-0800: 0.184: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 38319K-&gt;5119K<span style=color:#f92672>(</span>38400K<span style=color:#f92672>)]</span> 81586K-&gt;61396K<span style=color:#f92672>(</span>125952K<span style=color:#f92672>)</span>, 0.0091358 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.036-0800: 0.202: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 38399K-&gt;5119K<span style=color:#f92672>(</span>19968K<span style=color:#f92672>)]</span> 94676K-&gt;74085K<span style=color:#f92672>(</span>107520K<span style=color:#f92672>)</span>, 0.0100919 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.050-0800: 0.216: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 19851K-&gt;7473K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> 88816K-&gt;79274K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, 0.0030000 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.053-0800: 0.219: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 7473K-&gt;0K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 71800K-&gt;70817K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 79274K-&gt;70817K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0220339 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.11 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.082-0800: 0.248: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14823K-&gt;4802K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> 85640K-&gt;75619K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, 0.0015467 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.086-0800: 0.252: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 19650K-&gt;9309K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> 90467K-&gt;80126K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, 0.0018068 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.092-0800: 0.258: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 24001K-&gt;8277K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> 94818K-&gt;83744K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, 0.0029993 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.095-0800: 0.261: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 8277K-&gt;0K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 75467K-&gt;79210K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 83744K-&gt;79210K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0224154 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.12 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.125-0800: 0.291: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14731K-&gt;0K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 79210K-&gt;83484K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 93941K-&gt;83484K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0188675 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.11 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.146-0800: 0.312: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14367K-&gt;1235K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 83484K-&gt;86606K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 97851K-&gt;87842K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0255021 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.16 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.174-0800: 0.340: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14821K-&gt;5046K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 86606K-&gt;87242K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101427K-&gt;92288K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0185236 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.12 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.196-0800: 0.362: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14463K-&gt;8485K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87242K-&gt;86870K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101706K-&gt;95355K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0251259 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.16 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.223-0800: 0.389: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14779K-&gt;9297K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 86870K-&gt;87484K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101649K-&gt;96781K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0225548 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.15 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.248-0800: 0.414: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14518K-&gt;10348K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87484K-&gt;87310K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 102002K-&gt;97658K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0076190 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.257-0800: 0.423: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14816K-&gt;12611K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87310K-&gt;87190K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 102127K-&gt;99801K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0289935 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.20 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.287-0800: 0.453: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14813K-&gt;13881K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87190K-&gt;87130K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 102003K-&gt;101012K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0038787 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.291-0800: 0.457: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14831K-&gt;14006K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87130K-&gt;87130K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101961K-&gt;101136K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0018450 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.293-0800: 0.459: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Ergonomics<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14311K-&gt;14200K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87130K-&gt;87130K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101441K-&gt;101330K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0016810 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:09:30.295-0800: 0.461: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>PSYoungGen: 14200K-&gt;14200K<span style=color:#f92672>(</span>29184K<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>ParOldGen: 87130K-&gt;87111K<span style=color:#f92672>(</span>87552K<span style=color:#f92672>)]</span> 101330K-&gt;101311K<span style=color:#f92672>(</span>116736K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0293173 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.17 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
Exception in thread <span style=color:#e6db74>&#34;main&#34;</span> java.lang.OutOfMemoryError: Java heap space
	at GCLogAnalysis.generateGarbage<span style=color:#f92672>(</span>GCLogAnalysis.java:48<span style=color:#f92672>)</span>
	at GCLogAnalysis.main<span style=color:#f92672>(</span>GCLogAnalysis.java:25<span style=color:#f92672>)</span>
Heap
 PSYoungGen      total 29184K, used 14551K <span style=color:#f92672>[</span>0x00000007bd580000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
  eden space 14848K, 98% used <span style=color:#f92672>[</span>0x00000007bd580000,0x00000007be3b5ed0,0x00000007be400000<span style=color:#f92672>)</span>
  from space 14336K, 0% used <span style=color:#f92672>[</span>0x00000007bf200000,0x00000007bf200000,0x00000007c0000000<span style=color:#f92672>)</span>
  to   space 14336K, 0% used <span style=color:#f92672>[</span>0x00000007be400000,0x00000007be400000,0x00000007bf200000<span style=color:#f92672>)</span>
 ParOldGen       total 87552K, used 87111K <span style=color:#f92672>[</span>0x00000007b8000000, 0x00000007bd580000, 0x00000007bd580000<span style=color:#f92672>)</span>
  object space 87552K, 99% used <span style=color:#f92672>[</span>0x00000007b8000000,0x00000007bd511c70,0x00000007bd580000<span style=color:#f92672>)</span>
 Metaspace       used 2719K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 297K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>当堆内存降低至128m时，系统不仅频频发生Full GC，而且产生了<code>java.lang.OutOfMemoryError</code></p>
<p>而且在发生Full GC的时候，整个老年代及堆区被回收的对象很少，GC之后新生代Eden区的使用率达到98% 老年代使用率达到99%</p>
<h4 id=215-并行gc总结>2.1.5 并行GC总结</h4>
<ol>
<li>使用<code>-XX:+UseParallelGC</code>指定GC为并行GC</li>
<li>年轻代使用“标记-复制”算法</li>
<li>老年代使用“标记-清除-整理”算法</li>
<li>使用<code>-XX:ParallelGCThreads=N</code>来指定 GC 线程数，默认是机器CPU的核数</li>
<li>适用于多核的服务器，主要的目标是增加吞吐量
<ul>
<li>GC期间，所有的CPU内核都在并行清理垃圾，总的暂停时间更短</li>
<li>GC间隔，没有GC线程运行，不会消耗系统资源</li>
</ul>
</li>
<li>默认情况下会启用并行压缩，需要关闭的话则要指定参数<code>-XX:+UseParallelOldGC</code></li>
</ol>
<h3 id=22-串行gc的演示>2.2 串行GC的演示</h3>
<h4 id=221-使用512m堆内存>2.2.1 使用512m堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseSerialGC -Xms512m -Xmx512m -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-26T22:16:34.202-0800: 0.169: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.202-0800: 0.169: <span style=color:#f92672>[</span>DefNew: 139450K-&gt;17472K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0360407 secs<span style=color:#f92672>]</span> 139450K-&gt;54983K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0361185 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.278-0800: 0.246: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.279-0800: 0.246: <span style=color:#f92672>[</span>DefNew: 157201K-&gt;17469K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0431319 secs<span style=color:#f92672>]</span> 194713K-&gt;103739K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0431980 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.05 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.351-0800: 0.318: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.351-0800: 0.318: <span style=color:#f92672>[</span>DefNew: 157245K-&gt;17469K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0403336 secs<span style=color:#f92672>]</span> 243515K-&gt;153361K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0403988 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.414-0800: 0.382: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.414-0800: 0.382: <span style=color:#f92672>[</span>DefNew: 157245K-&gt;17470K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0364800 secs<span style=color:#f92672>]</span> 293137K-&gt;193188K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0365467 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.477-0800: 0.444: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.477-0800: 0.444: <span style=color:#f92672>[</span>DefNew: 156908K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0449685 secs<span style=color:#f92672>]</span> 332626K-&gt;242779K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0451249 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.05 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.550-0800: 0.518: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.550-0800: 0.518: <span style=color:#f92672>[</span>DefNew: 157247K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0389673 secs<span style=color:#f92672>]</span> 382555K-&gt;288695K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0390317 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.617-0800: 0.584: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.617-0800: 0.585: <span style=color:#f92672>[</span>DefNew: 157247K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0354948 secs<span style=color:#f92672>]</span> 428471K-&gt;332159K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0355636 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.676-0800: 0.644: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.676-0800: 0.644: <span style=color:#f92672>[</span>DefNew: 157247K-&gt;157247K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000357 secs<span style=color:#f92672>]</span>2020-10-26T22:16:34.676-0800: 0.644: <span style=color:#f92672>[</span>Tenured: 314687K-&gt;277678K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0734037 secs<span style=color:#f92672>]</span> 471935K-&gt;277678K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0735272 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.08 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.788-0800: 0.755: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.788-0800: 0.755: <span style=color:#f92672>[</span>DefNew: 139776K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0133521 secs<span style=color:#f92672>]</span> 417454K-&gt;325093K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0134581 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.833-0800: 0.800: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.833-0800: 0.800: <span style=color:#f92672>[</span>DefNew: 157247K-&gt;157247K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000314 secs<span style=color:#f92672>]</span>2020-10-26T22:16:34.833-0800: 0.800: <span style=color:#f92672>[</span>Tenured: 307621K-&gt;307464K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0653442 secs<span style=color:#f92672>]</span> 464869K-&gt;307464K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0654628 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:34.928-0800: 0.896: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:34.928-0800: 0.896: <span style=color:#f92672>[</span>DefNew: 139776K-&gt;139776K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000328 secs<span style=color:#f92672>]</span>2020-10-26T22:16:34.928-0800: 0.896: <span style=color:#f92672>[</span>Tenured: 307464K-&gt;322195K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0645899 secs<span style=color:#f92672>]</span> 447240K-&gt;322195K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0647116 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:35.022-0800: 0.989: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:35.022-0800: 0.989: <span style=color:#f92672>[</span>DefNew: 139386K-&gt;139386K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000488 secs<span style=color:#f92672>]</span>2020-10-26T22:16:35.022-0800: 0.990: <span style=color:#f92672>[</span>Tenured: 322195K-&gt;314828K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0637727 secs<span style=color:#f92672>]</span> 461582K-&gt;314828K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0639394 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-26T22:16:35.109-0800: 1.076: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-26T22:16:35.109-0800: 1.076: <span style=color:#f92672>[</span>DefNew: 139776K-&gt;139776K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000494 secs<span style=color:#f92672>]</span>2020-10-26T22:16:35.109-0800: 1.076: <span style=color:#f92672>[</span>Tenured: 314828K-&gt;343459K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0646202 secs<span style=color:#f92672>]</span> 454604K-&gt;343459K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0647652 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:6812
Heap
 def new generation   total 157248K, used 5654K <span style=color:#f92672>[</span>0x00000007a0000000, 0x00000007aaaa0000, 0x00000007aaaa0000<span style=color:#f92672>)</span>
  eden space 139776K,   4% used <span style=color:#f92672>[</span>0x00000007a0000000, 0x00000007a0585830, 0x00000007a8880000<span style=color:#f92672>)</span>
  from space 17472K,   0% used <span style=color:#f92672>[</span>0x00000007a8880000, 0x00000007a8880000, 0x00000007a9990000<span style=color:#f92672>)</span>
  to   space 17472K,   0% used <span style=color:#f92672>[</span>0x00000007a9990000, 0x00000007a9990000, 0x00000007aaaa0000<span style=color:#f92672>)</span>
 tenured generation   total 349568K, used 343459K <span style=color:#f92672>[</span>0x00000007aaaa0000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
   the space 349568K,  98% used <span style=color:#f92672>[</span>0x00000007aaaa0000, 0x00000007bfa08f30, 0x00000007bfa09000, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>首先观察日志最后Heap部分数据</p>
<p>程序执行完成后，堆内存中</p>
<ol>
<li>年轻代，总容量157248K，使用5654K，</li>
<li>老年代，总容量349568K，使用343459</li>
<li>元数据区，总计使用了2695K 容量是4486K JVM保证可用的大小是4864K 保留空间1G左右</li>
</ol>
<p><strong>Minor GC分析</strong></p>
<p>Minor GC事件的内容：</p>
<blockquote>
<p>2020-10-26T22:16:34.202-0800: 0.169: [GC (Allocation Failure) 2020-10-26T22:16:34.202-0800: 0.169: [DefNew: 139450K->17472K(157248K), 0.0360407 secs] 139450K->54983K(506816K), 0.0361185 secs] [Times: user=0.02 sys=0.01, real=0.03 secs]</p>
</blockquote>
<p>发生在JVM启动后的0.169秒，GC的原因是 <code>Allocation Failure</code> 分配内存失败，年轻代中没有空间存放新生成的对象。</p>
<p>DefNew 这个名字代表的是: <em>单线程(single-threaded), 采用标记复制(mark-copy)算法的, 使整个JVM暂停运行(stop-the-world)的年轻代(Young generation) 垃圾收集器(garbage collector)</em></p>
<p>139450K->17472K 表示垃圾收集前后的年轻代使用量，157248K 表示年轻代的总空间大小，GC使年轻代的使用率从88% 降至 11%，减少 121978K</p>
<p>0.0360407 secs 表示GC的持续时间</p>
<p>139450K->54983K 表示垃圾收集前后堆内存的使用情况，506816K表示 堆内存的总可用空间大小，GC使整个堆的使用率从 27% 降至 11%，减少 84467K</p>
<p>0.0360407 secs 表示GC的持续时间，可以发现 GC完整耗时与GC在年轻代的耗时相同，说明JVM启动后首次GC耗时均发生在年轻代上</p>
<p>也可以比较垃圾收集前年轻代的使用量和整个堆的使用量，发现两者相同，说明在GC之前老年代中并没有对象。</p>
<p>GC前后堆内存的使用量比年轻代的使用量减少的要小，可以得出从年轻代提升至老年代的对象约为 121978K - 84467K = 37511K</p>
<p>Times: user=0.02 sys=0.01, real=0.03 secs 表示此次GC事件的持续时间，30ms</p>
<p>user表示所有GC线程消耗的CPU时间</p>
<p>sys表示系统调用和系统等待事件消耗的时间</p>
<p>real表示应用程序暂停的时间</p>
<p>在本次GC中，因为使用的是串行GC，且只有单线程，所以在这里 real = user + sys</p>
<p><strong>Full GC分析</strong></p>
<p>Full GC事件内容：</p>
<blockquote>
<p>2020-10-26T22:16:34.676-0800: 0.644: [GC (Allocation Failure) 2020-10-26T22:16:34.676-0800: 0.644: [DefNew: 157247K->157247K(157248K), 0.0000357 secs]2020-10-26T22:16:34.676-0800: 0.644: [Tenured: 314687K->277678K(349568K), 0.0734037 secs] 471935K->277678K(506816K), [Metaspace: 2689K->2689K(1056768K)], 0.0735272 secs] [Times: user=0.07 sys=0.00, real=0.08 secs]</p>
</blockquote>
<p>2020-10-26T22:16:34.676-0800: 0.644: [DefNew: 157247K->157247K(157248K), 0.0000357 secs]</p>
<p>内存分配失败导致了一次年轻代GC，但是此次年轻代GC堆内存的使用量没有变化，使用量达到99.99%，年轻代几乎用满，且耗时几乎为0</p>
<p>2020-10-26T22:16:34.676-0800: 0.644: [Tenured: 314687K->277678K(349568K), 0.0734037 secs]</p>
<p>Tenured 代表清理老年代使用的垃圾收集器名称，单线程的STW垃圾收集器，使用的算法为 标记‐清除‐整理(mark‐sweep‐ compact ) 。</p>
<p>GC前后老年的使用量从314687K降至277678K，总的老年代空间大小为349568K</p>
<p>GC之后，老年代的堆内存使用量下降37009K 使用率从90% 降至 79%</p>
<p>471935K->277678K(506816K) 表示堆内存在GC前后的使用量，使用量下降 194257 使用率从93% 下降至 55%</p>
<p>这次Full GC之后老年代的使用量和整个堆的使用量相同，那么是否是年轻代的使用量在Tenured之后变为了0，只是日志体现的是Tenured之前的年轻代GC，所以在日志中没有体现？？？</p>
<p>[Metaspace: 2689K->2689K(1056768K)]</p>
<p>元数据库内存使用没有变化</p>
<p>[Times: user=0.07 sys=0.00, real=0.08 secs]</p>
<p>此次GC合计耗时80ms</p>
<h4 id=222-使用128m堆内存>2.2.2 使用128m堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseSerialGC -Xms128m -Xmx128m -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T11:12:39.633-0800: 0.104: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.633-0800: 0.105: <span style=color:#f92672>[</span>DefNew: 34944K-&gt;4351K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0091493 secs<span style=color:#f92672>]</span> 34944K-&gt;12494K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0092266 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.658-0800: 0.130: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.658-0800: 0.130: <span style=color:#f92672>[</span>DefNew: 39284K-&gt;4349K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0170365 secs<span style=color:#f92672>]</span> 47427K-&gt;25816K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0171250 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.690-0800: 0.162: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.690-0800: 0.162: <span style=color:#f92672>[</span>DefNew: 39277K-&gt;4351K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0128654 secs<span style=color:#f92672>]</span> 60744K-&gt;39193K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0129536 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.718-0800: 0.189: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.718-0800: 0.189: <span style=color:#f92672>[</span>DefNew: 39295K-&gt;4334K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0135349 secs<span style=color:#f92672>]</span> 74137K-&gt;51634K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0136381 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.738-0800: 0.210: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.738-0800: 0.210: <span style=color:#f92672>[</span>DefNew: 39278K-&gt;4350K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0100082 secs<span style=color:#f92672>]</span> 86578K-&gt;65081K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0100772 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.763-0800: 0.235: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.763-0800: 0.235: <span style=color:#f92672>[</span>DefNew: 39279K-&gt;4346K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0146205 secs<span style=color:#f92672>]</span> 100010K-&gt;77928K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, 0.0147487 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.784-0800: 0.256: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.784-0800: 0.256: <span style=color:#f92672>[</span>DefNew: 39290K-&gt;39290K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0000325 secs<span style=color:#f92672>]</span>2020-10-27T11:12:39.784-0800: 0.256: <span style=color:#f92672>[</span>Tenured: 73582K-&gt;83357K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0211825 secs<span style=color:#f92672>]</span> 112872K-&gt;83357K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0213299 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.816-0800: 0.288: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.816-0800: 0.288: <span style=color:#f92672>[</span>DefNew: 34229K-&gt;34229K<span style=color:#f92672>(</span>39296K<span style=color:#f92672>)</span>, 0.0000539 secs<span style=color:#f92672>]</span>2020-10-27T11:12:39.816-0800: 0.288: <span style=color:#f92672>[</span>Tenured: 83357K-&gt;87278K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0296567 secs<span style=color:#f92672>]</span> 117586K-&gt;92405K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0298485 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.859-0800: 0.331: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.859-0800: 0.331: <span style=color:#f92672>[</span>Tenured: 87278K-&gt;87113K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0341419 secs<span style=color:#f92672>]</span> 126121K-&gt;101878K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0342425 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.899-0800: 0.371: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.899-0800: 0.371: <span style=color:#f92672>[</span>Tenured: 87113K-&gt;87406K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0270719 secs<span style=color:#f92672>]</span> 126021K-&gt;106166K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0272392 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.930-0800: 0.402: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.930-0800: 0.402: <span style=color:#f92672>[</span>Tenured: 87406K-&gt;87406K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0034222 secs<span style=color:#f92672>]</span> 126628K-&gt;111789K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0034929 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.935-0800: 0.407: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.935-0800: 0.407: <span style=color:#f92672>[</span>Tenured: 87406K-&gt;87406K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0048305 secs<span style=color:#f92672>]</span> 126554K-&gt;115996K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0049248 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.942-0800: 0.414: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.942-0800: 0.414: <span style=color:#f92672>[</span>Tenured: 87406K-&gt;87245K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0093468 secs<span style=color:#f92672>]</span> 126700K-&gt;120097K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0094152 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.954-0800: 0.425: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.954-0800: 0.425: <span style=color:#f92672>[</span>Tenured: 87421K-&gt;87301K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0229400 secs<span style=color:#f92672>]</span> 126708K-&gt;117971K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0230235 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.978-0800: 0.450: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.978-0800: 0.450: <span style=color:#f92672>[</span>Tenured: 87301K-&gt;87301K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0073974 secs<span style=color:#f92672>]</span> 126286K-&gt;119722K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0074798 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.987-0800: 0.459: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.987-0800: 0.459: <span style=color:#f92672>[</span>Tenured: 87301K-&gt;87301K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0048841 secs<span style=color:#f92672>]</span> 126309K-&gt;121072K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0049778 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.993-0800: 0.465: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.993-0800: 0.465: <span style=color:#f92672>[</span>Tenured: 87301K-&gt;87301K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0048639 secs<span style=color:#f92672>]</span> 126484K-&gt;122840K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0049178 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:39.998-0800: 0.470: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:39.999-0800: 0.470: <span style=color:#f92672>[</span>Tenured: 87301K-&gt;86827K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0204955 secs<span style=color:#f92672>]</span> 126581K-&gt;123367K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0206002 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.021-0800: 0.493: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.021-0800: 0.493: <span style=color:#f92672>[</span>Tenured: 87280K-&gt;87280K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0027976 secs<span style=color:#f92672>]</span> 126481K-&gt;124145K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0028881 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.025-0800: 0.497: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.025-0800: 0.497: <span style=color:#f92672>[</span>Tenured: 87280K-&gt;87280K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0024275 secs<span style=color:#f92672>]</span> 126321K-&gt;125053K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0025057 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.028-0800: 0.499: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.028-0800: 0.499: <span style=color:#f92672>[</span>Tenured: 87280K-&gt;87280K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0013018 secs<span style=color:#f92672>]</span> 126417K-&gt;125676K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0013524 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.029-0800: 0.501: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.029-0800: 0.501: <span style=color:#f92672>[</span>Tenured: 87280K-&gt;86936K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0148080 secs<span style=color:#f92672>]</span> 126435K-&gt;125631K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0148632 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.044-0800: 0.516: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.044-0800: 0.516: <span style=color:#f92672>[</span>Tenured: 87354K-&gt;87354K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0016582 secs<span style=color:#f92672>]</span> 126597K-&gt;126044K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0017080 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.046-0800: 0.518: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.046-0800: 0.518: <span style=color:#f92672>[</span>Tenured: 87354K-&gt;87354K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0012578 secs<span style=color:#f92672>]</span> 126199K-&gt;126044K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0013884 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T11:12:40.048-0800: 0.520: <span style=color:#f92672>[</span>Full GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T11:12:40.048-0800: 0.520: <span style=color:#f92672>[</span>Tenured: 87354K-&gt;87221K<span style=color:#f92672>(</span>87424K<span style=color:#f92672>)</span>, 0.0224445 secs<span style=color:#f92672>]</span> 126044K-&gt;125911K<span style=color:#f92672>(</span>126720K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0225360 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.02 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
Exception in thread <span style=color:#e6db74>&#34;main&#34;</span> java.lang.OutOfMemoryError: Java heap space
	at GCLogAnalysis.generateGarbage<span style=color:#f92672>(</span>GCLogAnalysis.java:48<span style=color:#f92672>)</span>
	at GCLogAnalysis.main<span style=color:#f92672>(</span>GCLogAnalysis.java:25<span style=color:#f92672>)</span>
Heap
 def new generation   total 39296K, used 38914K <span style=color:#f92672>[</span>0x00000007b8000000, 0x00000007baaa0000, 0x00000007baaa0000<span style=color:#f92672>)</span>
  eden space 34944K, 100% used <span style=color:#f92672>[</span>0x00000007b8000000, 0x00000007ba220000, 0x00000007ba220000<span style=color:#f92672>)</span>
  from space 4352K,  91% used <span style=color:#f92672>[</span>0x00000007ba220000, 0x00000007ba600b78, 0x00000007ba660000<span style=color:#f92672>)</span>
  to   space 4352K,   0% used <span style=color:#f92672>[</span>0x00000007ba660000, 0x00000007ba660000, 0x00000007baaa0000<span style=color:#f92672>)</span>
 tenured generation   total 87424K, used 87221K <span style=color:#f92672>[</span>0x00000007baaa0000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
   the space 87424K,  99% used <span style=color:#f92672>[</span>0x00000007baaa0000, 0x00000007bffcd648, 0x00000007bffcd800, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2719K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 297K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>可以看出程序执行导致了堆内存溢出 触发了 <code>java.lang.OutOfMemoryError</code></p>
<ol>
<li>年轻代 总容量39296K 使用38914K Eden区使用率达到100%</li>
<li>老年代 使用率99%</li>
<li>堆内存几乎用满，无法再分配对象尝试Full GC失败 导致OOM</li>
</ol>
<p>首先触发了6次Minor GC，清理年轻代</p>
<p>随后发生了两次 GC （未标明是Full GC）,既清理了年轻代，也清理了老年代和元数据区，只是在几乎未对年轻代清理的情况下 老年代使用量竟让上涨了。</p>
<h4 id=223-使用1g堆内存>2.2.3 使用1g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseSerialGC -Xms1g -Xmx1g -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T21:11:18.890-0800: 0.250: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:18.890-0800: 0.250: <span style=color:#f92672>[</span>DefNew: 279616K-&gt;34944K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0496792 secs<span style=color:#f92672>]</span> 279616K-&gt;82661K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0497561 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:18.993-0800: 0.354: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:18.993-0800: 0.354: <span style=color:#f92672>[</span>DefNew: 314560K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0700488 secs<span style=color:#f92672>]</span> 362277K-&gt;160948K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0701214 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.111-0800: 0.472: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.112-0800: 0.472: <span style=color:#f92672>[</span>DefNew: 314559K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0596861 secs<span style=color:#f92672>]</span> 440564K-&gt;242355K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0597577 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.220-0800: 0.580: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.220-0800: 0.580: <span style=color:#f92672>[</span>DefNew: 314310K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0541097 secs<span style=color:#f92672>]</span> 521721K-&gt;318969K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0541829 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.05 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.321-0800: 0.682: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.321-0800: 0.682: <span style=color:#f92672>[</span>DefNew: 314262K-&gt;34942K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0684594 secs<span style=color:#f92672>]</span> 598287K-&gt;406393K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0685505 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.444-0800: 0.805: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.444-0800: 0.805: <span style=color:#f92672>[</span>DefNew: 314558K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0710469 secs<span style=color:#f92672>]</span> 686009K-&gt;491481K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0711163 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.566-0800: 0.927: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.566-0800: 0.927: <span style=color:#f92672>[</span>DefNew: 314559K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0546956 secs<span style=color:#f92672>]</span> 771097K-&gt;562797K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0547539 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-27T21:11:19.669-0800: 1.029: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:11:19.669-0800: 1.030: <span style=color:#f92672>[</span>DefNew: 314559K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0573799 secs<span style=color:#f92672>]</span> 842413K-&gt;644270K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0574553 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:8765
Heap
 def new generation   total 314560K, used 85051K <span style=color:#f92672>[</span>0x0000000780000000, 0x0000000795550000, 0x0000000795550000<span style=color:#f92672>)</span>
  eden space 279616K,  17% used <span style=color:#f92672>[</span>0x0000000780000000, 0x00000007830eefc8, 0x0000000791110000<span style=color:#f92672>)</span>
  from space 34944K,  99% used <span style=color:#f92672>[</span>0x0000000791110000, 0x000000079332fff0, 0x0000000793330000<span style=color:#f92672>)</span>
  to   space 34944K,   0% used <span style=color:#f92672>[</span>0x0000000793330000, 0x0000000793330000, 0x0000000795550000<span style=color:#f92672>)</span>
 tenured generation   total 699072K, used 609326K <span style=color:#f92672>[</span>0x0000000795550000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
   the space 699072K,  87% used <span style=color:#f92672>[</span>0x0000000795550000, 0x00000007ba85b978, 0x00000007ba85ba00, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>使用1g堆内存后，共发生8次Minor GC，未发生老年代GC，GC时间从50ms到70ms不等。</p>
<p>随着堆内存的配置越来越大，程序产生的对象也随之增多。</p>
<h4 id=224-使用2g堆内存>2.2.4 使用2g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseSerialGC -Xms2g -Xmx2g -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T21:23:03.643-0800: 0.387: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:23:03.643-0800: 0.387: <span style=color:#f92672>[</span>DefNew: 559232K-&gt;69888K<span style=color:#f92672>(</span>629120K<span style=color:#f92672>)</span>, 0.0887940 secs<span style=color:#f92672>]</span> 559232K-&gt;150907K<span style=color:#f92672>(</span>2027264K<span style=color:#f92672>)</span>, 0.0888694 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.09 secs<span style=color:#f92672>]</span>
2020-10-27T21:23:03.840-0800: 0.584: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:23:03.840-0800: 0.584: <span style=color:#f92672>[</span>DefNew: 629120K-&gt;69887K<span style=color:#f92672>(</span>629120K<span style=color:#f92672>)</span>, 0.1088363 secs<span style=color:#f92672>]</span> 710139K-&gt;272051K<span style=color:#f92672>(</span>2027264K<span style=color:#f92672>)</span>, 0.1089175 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.05, real<span style=color:#f92672>=</span>0.10 secs<span style=color:#f92672>]</span>
2020-10-27T21:23:04.054-0800: 0.799: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:23:04.054-0800: 0.799: <span style=color:#f92672>[</span>DefNew: 629119K-&gt;69888K<span style=color:#f92672>(</span>629120K<span style=color:#f92672>)</span>, 0.0948227 secs<span style=color:#f92672>]</span> 831283K-&gt;400122K<span style=color:#f92672>(</span>2027264K<span style=color:#f92672>)</span>, 0.0948869 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.06 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.09 secs<span style=color:#f92672>]</span>
2020-10-27T21:23:04.243-0800: 0.988: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:23:04.243-0800: 0.988: <span style=color:#f92672>[</span>DefNew: 629120K-&gt;69887K<span style=color:#f92672>(</span>629120K<span style=color:#f92672>)</span>, 0.0842347 secs<span style=color:#f92672>]</span> 959354K-&gt;522406K<span style=color:#f92672>(</span>2027264K<span style=color:#f92672>)</span>, 0.0843166 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.08 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:8619
Heap
 def new generation   total 629120K, used 137193K <span style=color:#f92672>[</span>0x0000000740000000, 0x000000076aaa0000, 0x000000076aaa0000<span style=color:#f92672>)</span>
  eden space 559232K,  12% used <span style=color:#f92672>[</span>0x0000000740000000, 0x00000007441ba4c8, 0x0000000762220000<span style=color:#f92672>)</span>
  from space 69888K,  99% used <span style=color:#f92672>[</span>0x0000000762220000, 0x000000076665fff0, 0x0000000766660000<span style=color:#f92672>)</span>
  to   space 69888K,   0% used <span style=color:#f92672>[</span>0x0000000766660000, 0x0000000766660000, 0x000000076aaa0000<span style=color:#f92672>)</span>
 tenured generation   total 1398144K, used 452518K <span style=color:#f92672>[</span>0x000000076aaa0000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
   the space 1398144K,  32% used <span style=color:#f92672>[</span>0x000000076aaa0000, 0x0000000786489ad0, 0x0000000786489c00, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>这次只发生了4次Minor GC 耗时在80到100ms之间，可见耗时比堆内存为1g时要多</p>
<p>程序生成的对象却没有明显地增多</p>
<h4 id=225-使用4g堆内存>2.2.5 使用4g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseSerialGC -Xms4g -Xmx4g -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T21:42:05.545-0800: 0.673: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:42:05.545-0800: 0.673: <span style=color:#f92672>[</span>DefNew: 1118528K-&gt;139775K<span style=color:#f92672>(</span>1258304K<span style=color:#f92672>)</span>, 0.1543860 secs<span style=color:#f92672>]</span> 1118528K-&gt;243637K<span style=color:#f92672>(</span>4054528K<span style=color:#f92672>)</span>, 0.1544662 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.09 sys<span style=color:#f92672>=</span>0.07, real<span style=color:#f92672>=</span>0.15 secs<span style=color:#f92672>]</span>
2020-10-27T21:42:05.906-0800: 1.035: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T21:42:05.906-0800: 1.035: <span style=color:#f92672>[</span>DefNew: 1258303K-&gt;139775K<span style=color:#f92672>(</span>1258304K<span style=color:#f92672>)</span>, 0.1673658 secs<span style=color:#f92672>]</span> 1362165K-&gt;399506K<span style=color:#f92672>(</span>4054528K<span style=color:#f92672>)</span>, 0.1674364 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.09 sys<span style=color:#f92672>=</span>0.07, real<span style=color:#f92672>=</span>0.17 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:8370
Heap
 def new generation   total 1258304K, used 184640K <span style=color:#f92672>[</span>0x00000006c0000000, 0x0000000715550000, 0x0000000715550000<span style=color:#f92672>)</span>
  eden space 1118528K,   4% used <span style=color:#f92672>[</span>0x00000006c0000000, 0x00000006c2bd0210, 0x0000000704450000<span style=color:#f92672>)</span>
  from space 139776K,  99% used <span style=color:#f92672>[</span>0x0000000704450000, 0x000000070cccfff8, 0x000000070ccd0000<span style=color:#f92672>)</span>
  to   space 139776K,   0% used <span style=color:#f92672>[</span>0x000000070ccd0000, 0x000000070ccd0000, 0x0000000715550000<span style=color:#f92672>)</span>
 tenured generation   total 2796224K, used 259730K <span style=color:#f92672>[</span>0x0000000715550000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
   the space 2796224K,   9% used <span style=color:#f92672>[</span>0x0000000715550000, 0x00000007252f4b58, 0x00000007252f4c00, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>GC执行时间边长，但是生成的对象并没有明显增长</p>
<h4 id=226-串行gc总结>2.2.6 串行GC总结</h4>
<ol>
<li>使用<code>-XX:+UseSerialGC</code>指定GC算法</li>
<li>对年轻代使用 “标记-复制”算法</li>
<li>对老年代使用“标记-清除-整理”算法</li>
<li>单线程，所以对年轻代和老年代的处理都会"stop the world"，停止应用线程进行GC</li>
<li>不能使用多核CPU，暂停时间也更长</li>
<li>优点：CPU的利用率较高</li>
</ol>
<h3 id=23-cms-gc的演示>2.3 CMS GC的演示</h3>
<h4 id=231-使用512m堆内存配置>2.3.1 使用512m堆内存配置</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseConcMarkSweepGC -Xms512m -Xmx512m -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-27T22:39:39.458-0800: 0.169: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.458-0800: 0.169: <span style=color:#f92672>[</span>ParNew: 139776K-&gt;17470K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0213819 secs<span style=color:#f92672>]</span> 139776K-&gt;48287K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0214863 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.04 sys<span style=color:#f92672>=</span>0.10, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.508-0800: 0.219: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.508-0800: 0.219: <span style=color:#f92672>[</span>ParNew: 157246K-&gt;17472K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0333864 secs<span style=color:#f92672>]</span> 188063K-&gt;94437K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0334829 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.08 sys<span style=color:#f92672>=</span>0.14, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.575-0800: 0.286: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.575-0800: 0.286: <span style=color:#f92672>[</span>ParNew: 157248K-&gt;17472K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0423986 secs<span style=color:#f92672>]</span> 234213K-&gt;145799K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0424847 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.29 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.639-0800: 0.350: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.640-0800: 0.351: <span style=color:#f92672>[</span>ParNew: 156619K-&gt;17470K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0376706 secs<span style=color:#f92672>]</span> 284947K-&gt;183380K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0377727 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.25 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.709-0800: 0.420: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.709-0800: 0.420: <span style=color:#f92672>[</span>ParNew: 157246K-&gt;17468K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0369231 secs<span style=color:#f92672>]</span> 323156K-&gt;226601K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0370328 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.26 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.746-0800: 0.457: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Initial Mark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> CMS-initial-mark: 209132K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)]</span> 226891K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0004101 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.746-0800: 0.457: <span style=color:#f92672>[</span>CMS-concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-27T22:39:39.748-0800: 0.459: <span style=color:#f92672>[</span>CMS-concurrent-mark: 0.002/0.002 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.748-0800: 0.459: <span style=color:#f92672>[</span>CMS-concurrent-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:39.749-0800: 0.460: <span style=color:#f92672>[</span>CMS-concurrent-preclean: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.749-0800: 0.460: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:39.768-0800: 0.479: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.768-0800: 0.479: <span style=color:#f92672>[</span>ParNew: 157244K-&gt;17470K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0398063 secs<span style=color:#f92672>]</span> 366377K-&gt;268186K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0398829 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.26 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.840-0800: 0.551: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.840-0800: 0.551: <span style=color:#f92672>[</span>ParNew: 157228K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0392140 secs<span style=color:#f92672>]</span> 407944K-&gt;312914K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0393009 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.27 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.900-0800: 0.611: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.900-0800: 0.611: <span style=color:#f92672>[</span>ParNew: 157247K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0450912 secs<span style=color:#f92672>]</span> 452690K-&gt;363166K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0451946 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.31 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.945-0800: 0.656: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean: 0.003/0.197 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.93 sys<span style=color:#f92672>=</span>0.09, real<span style=color:#f92672>=</span>0.20 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.946-0800: 0.657: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Final Remark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>YG occupancy: <span style=color:#ae81ff>20360</span> K <span style=color:#f92672>(</span><span style=color:#ae81ff>157248</span> K<span style=color:#f92672>)]</span>2020-10-27T22:39:39.946-0800: 0.657: <span style=color:#f92672>[</span>Rescan <span style=color:#f92672>(</span>parallel<span style=color:#f92672>)</span> , 0.0004848 secs<span style=color:#f92672>]</span>2020-10-27T22:39:39.946-0800: 0.657: <span style=color:#f92672>[</span>weak refs processing, 0.0000389 secs<span style=color:#f92672>]</span>2020-10-27T22:39:39.946-0800: 0.657: <span style=color:#f92672>[</span>class unloading, 0.0003198 secs<span style=color:#f92672>]</span>2020-10-27T22:39:39.946-0800: 0.657: <span style=color:#f92672>[</span>scrub symbol table, 0.0004675 secs<span style=color:#f92672>]</span>2020-10-27T22:39:39.947-0800: 0.658: <span style=color:#f92672>[</span>scrub string table, 0.0001561 secs<span style=color:#f92672>][</span><span style=color:#ae81ff>1</span> CMS-remark: 345694K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)]</span> 366054K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0015994 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.947-0800: 0.658: <span style=color:#f92672>[</span>CMS-concurrent-sweep-start<span style=color:#f92672>]</span>
2020-10-27T22:39:39.948-0800: 0.659: <span style=color:#f92672>[</span>CMS-concurrent-sweep: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.948-0800: 0.659: <span style=color:#f92672>[</span>CMS-concurrent-reset-start<span style=color:#f92672>]</span>
2020-10-27T22:39:39.949-0800: 0.660: <span style=color:#f92672>[</span>CMS-concurrent-reset: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:39.980-0800: 0.691: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:39.980-0800: 0.691: <span style=color:#f92672>[</span>ParNew: 156971K-&gt;156971K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000456 secs<span style=color:#f92672>]</span>2020-10-27T22:39:39.980-0800: 0.691: <span style=color:#f92672>[</span>CMS: 295961K-&gt;257240K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0866539 secs<span style=color:#f92672>]</span> 452933K-&gt;257240K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0868169 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.08 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.08 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.067-0800: 0.778: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Initial Mark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> CMS-initial-mark: 257240K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)]</span> 257575K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0002127 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.067-0800: 0.778: <span style=color:#f92672>[</span>CMS-concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.068-0800: 0.779: <span style=color:#f92672>[</span>CMS-concurrent-mark: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.068-0800: 0.779: <span style=color:#f92672>[</span>CMS-concurrent-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.069-0800: 0.780: <span style=color:#f92672>[</span>CMS-concurrent-preclean: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.069-0800: 0.780: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.099-0800: 0.810: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:40.099-0800: 0.810: <span style=color:#f92672>[</span>ParNew: 139308K-&gt;17471K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0086479 secs<span style=color:#f92672>]</span> 396548K-&gt;302259K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0087297 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.05 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.146-0800: 0.857: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:40.146-0800: 0.857: <span style=color:#f92672>[</span>ParNew: 157247K-&gt;17465K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0211116 secs<span style=color:#f92672>]</span> 442035K-&gt;341391K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0212073 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.15 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.202-0800: 0.913: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:40.202-0800: 0.913: <span style=color:#f92672>[</span>ParNew: 156731K-&gt;156731K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000506 secs<span style=color:#f92672>]</span>2020-10-27T22:39:40.202-0800: 0.913: <span style=color:#f92672>[</span>CMS2020-10-27T22:39:40.202-0800: 0.913: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean: 0.003/0.133 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.31 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.14 secs<span style=color:#f92672>]</span>
 <span style=color:#f92672>(</span>concurrent mode failure<span style=color:#f92672>)</span>: 323925K-&gt;294545K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0699941 secs<span style=color:#f92672>]</span> 480657K-&gt;294545K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0701788 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.294-0800: 1.005: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:40.294-0800: 1.005: <span style=color:#f92672>[</span>ParNew: 139776K-&gt;17468K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0181598 secs<span style=color:#f92672>]</span> 434321K-&gt;336614K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0182725 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.13 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.02 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.313-0800: 1.024: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Initial Mark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> CMS-initial-mark: 319146K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)]</span> 336902K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, 0.0002534 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.313-0800: 1.024: <span style=color:#f92672>[</span>CMS-concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.314-0800: 1.025: <span style=color:#f92672>[</span>CMS-concurrent-mark: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.315-0800: 1.026: <span style=color:#f92672>[</span>CMS-concurrent-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.315-0800: 1.026: <span style=color:#f92672>[</span>CMS-concurrent-preclean: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-27T22:39:40.315-0800: 1.026: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean-start<span style=color:#f92672>]</span>
2020-10-27T22:39:40.346-0800: 1.058: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-27T22:39:40.347-0800: 1.058: <span style=color:#f92672>[</span>ParNew: 157244K-&gt;157244K<span style=color:#f92672>(</span>157248K<span style=color:#f92672>)</span>, 0.0000761 secs<span style=color:#f92672>]</span>2020-10-27T22:39:40.347-0800: 1.058: <span style=color:#f92672>[</span>CMS2020-10-27T22:39:40.347-0800: 1.058: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean: 0.001/0.032 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.03 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
 <span style=color:#f92672>(</span>concurrent mode failure<span style=color:#f92672>)</span>: 319146K-&gt;312120K<span style=color:#f92672>(</span>349568K<span style=color:#f92672>)</span>, 0.0707347 secs<span style=color:#f92672>]</span> 476390K-&gt;312120K<span style=color:#f92672>(</span>506816K<span style=color:#f92672>)</span>, <span style=color:#f92672>[</span>Metaspace: 2689K-&gt;2689K<span style=color:#f92672>(</span>1056768K<span style=color:#f92672>)]</span>, 0.0709816 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:7363
Heap
 par new generation   total 157248K, used 5677K <span style=color:#f92672>[</span>0x00000007a0000000, 0x00000007aaaa0000, 0x00000007aaaa0000<span style=color:#f92672>)</span>
  eden space 139776K,   4% used <span style=color:#f92672>[</span>0x00000007a0000000, 0x00000007a058b560, 0x00000007a8880000<span style=color:#f92672>)</span>
  from space 17472K,   0% used <span style=color:#f92672>[</span>0x00000007a9990000, 0x00000007a9990000, 0x00000007aaaa0000<span style=color:#f92672>)</span>
  to   space 17472K,   0% used <span style=color:#f92672>[</span>0x00000007a8880000, 0x00000007a8880000, 0x00000007a9990000<span style=color:#f92672>)</span>
 concurrent mark-sweep generation total 349568K, used 312120K <span style=color:#f92672>[</span>0x00000007aaaa0000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><blockquote>
<p>2020-10-27T22:39:39.458-0800: 0.169: [GC (Allocation Failure) 2020-10-27T22:39:39.458-0800: 0.169: [ParNew: 139776K->17470K(157248K), 0.0213819 secs] 139776K->48287K(506816K), 0.0214863 secs] [Times: user=0.04 sys=0.10, real=0.03 secs]</p>
</blockquote>
<p>第一次年轻代GC</p>
<p>使用的GC算法是 ParNew算法</p>
<blockquote>
<p>2020-10-27T22:39:39.746-0800: 0.457: [GC (CMS Initial Mark) [1 CMS-initial-mark: 209132K(349568K)] 226891K(506816K), 0.0004101 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
<p>2020-10-27T22:39:39.746-0800: 0.457: [CMS-concurrent-mark-start]</p>
<p>2020-10-27T22:39:39.748-0800: 0.459: [CMS-concurrent-mark: 0.002/0.002 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
<p>2020-10-27T22:39:39.748-0800: 0.459: [CMS-concurrent-preclean-start]</p>
<p>2020-10-27T22:39:39.749-0800: 0.460: [CMS-concurrent-preclean: 0.001/0.001 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
<p>2020-10-27T22:39:39.749-0800: 0.460: [CMS-concurrent-abortable-preclean-start]</p>
<p>2020-10-27T22:39:39.945-0800: 0.656: [CMS-concurrent-abortable-preclean: 0.003/0.197 secs] [Times: user=0.93 sys=0.09, real=0.20 secs]</p>
<p>2020-10-27T22:39:39.946-0800: 0.657: [GC (CMS Final Remark) [YG occupancy: 20360 K (157248 K)]2020-10-27T22:39:39.946-0800: 0.657: [Rescan (parallel) , 0.0004848 secs]2020-10-27T22:39:39.946-0800: 0.657: [weak refs processing, 0.0000389 secs]2020-10-27T22:39:39.946-0800: 0.657: [class unloading, 0.0003198 secs]2020-10-27T22:39:39.946-0800: 0.657: [scrub symbol table, 0.0004675 secs]2020-10-27T22:39:39.947-0800: 0.658: [scrub string table, 0.0001561 secs][1 CMS-remark: 345694K(349568K)] 366054K(506816K), 0.0015994 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
<p>2020-10-27T22:39:39.947-0800: 0.658: [CMS-concurrent-sweep-start]</p>
<p>2020-10-27T22:39:39.948-0800: 0.659: [CMS-concurrent-sweep: 0.001/0.001 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
<p>2020-10-27T22:39:39.948-0800: 0.659: [CMS-concurrent-reset-start]</p>
<p>2020-10-27T22:39:39.949-0800: 0.660: [CMS-concurrent-reset: 0.001/0.001 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p>
</blockquote>
<p>第一次 CMS GC，可以看出CMS GC共有6个步骤</p>
<ol>
<li>CMS Initial Mark 初始标记</li>
<li>CMS-concurrent-mark 并发标记</li>
<li>CMS-concurrent-preclean 并发预清理</li>
<li>CMS Final Remark 最终标记</li>
<li>CMS-concurrent-sweep 并发清除</li>
<li>CMS-concurrent-reset 并发重置</li>
</ol>
<p>其中初始标记和最终标记阶段没有concurrent，表示在此期间将会发生STW，停止业务线程</p>
<p>其余阶段均可以与业务线程并发执行，此时默认的执行GC的线程数为机器CPU核心数的1/4。</p>
<h4 id=232-使用1g堆内存>2.3.2 使用1g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseConcMarkSweepGC -Xms1g -Xmx1g -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-28T21:29:26.158-0800: 0.280: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.158-0800: 0.281: <span style=color:#f92672>[</span>ParNew: 279616K-&gt;34944K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0431802 secs<span style=color:#f92672>]</span> 279616K-&gt;90159K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0432705 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.07 sys<span style=color:#f92672>=</span>0.20, real<span style=color:#f92672>=</span>0.05 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.261-0800: 0.383: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.261-0800: 0.383: <span style=color:#f92672>[</span>ParNew: 314560K-&gt;34942K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0436206 secs<span style=color:#f92672>]</span> 369775K-&gt;165049K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0436886 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.09 sys<span style=color:#f92672>=</span>0.20, real<span style=color:#f92672>=</span>0.04 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.360-0800: 0.482: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.360-0800: 0.482: <span style=color:#f92672>[</span>ParNew: 314558K-&gt;34944K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0678416 secs<span style=color:#f92672>]</span> 444665K-&gt;250958K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0679174 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.47 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.479-0800: 0.601: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.479-0800: 0.601: <span style=color:#f92672>[</span>ParNew: 314560K-&gt;34944K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0656349 secs<span style=color:#f92672>]</span> 530574K-&gt;333860K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0657094 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.45 sys<span style=color:#f92672>=</span>0.05, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.595-0800: 0.717: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.595-0800: 0.717: <span style=color:#f92672>[</span>ParNew: 314560K-&gt;34942K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0616112 secs<span style=color:#f92672>]</span> 613476K-&gt;405206K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0616833 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.43 sys<span style=color:#f92672>=</span>0.04, real<span style=color:#f92672>=</span>0.06 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.657-0800: 0.779: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Initial Mark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> CMS-initial-mark: 370263K<span style=color:#f92672>(</span>699072K<span style=color:#f92672>)]</span> 410753K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0003411 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.657-0800: 0.780: <span style=color:#f92672>[</span>CMS-concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:29:26.661-0800: 0.783: <span style=color:#f92672>[</span>CMS-concurrent-mark: 0.003/0.003 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.661-0800: 0.783: <span style=color:#f92672>[</span>CMS-concurrent-preclean-start<span style=color:#f92672>]</span>
2020-10-28T21:29:26.662-0800: 0.784: <span style=color:#f92672>[</span>CMS-concurrent-preclean: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.662-0800: 0.784: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean-start<span style=color:#f92672>]</span>
2020-10-28T21:29:26.718-0800: 0.840: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.718-0800: 0.840: <span style=color:#f92672>[</span>ParNew2020-10-28T21:29:26.767-0800: 0.889: <span style=color:#f92672>[</span>CMS-concurrent-abortable-preclean: 0.001/0.105 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.39 sys<span style=color:#f92672>=</span>0.03, real<span style=color:#f92672>=</span>0.10 secs<span style=color:#f92672>]</span>
: 314558K-&gt;34944K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0699358 secs<span style=color:#f92672>]</span> 684822K-&gt;482118K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0700242 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.47 sys<span style=color:#f92672>=</span>0.05, real<span style=color:#f92672>=</span>0.07 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.788-0800: 0.911: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Final Remark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>YG occupancy: <span style=color:#ae81ff>35424</span> K <span style=color:#f92672>(</span><span style=color:#ae81ff>314560</span> K<span style=color:#f92672>)]</span>2020-10-28T21:29:26.788-0800: 0.911: <span style=color:#f92672>[</span>Rescan <span style=color:#f92672>(</span>parallel<span style=color:#f92672>)</span> , 0.0005293 secs<span style=color:#f92672>]</span>2020-10-28T21:29:26.789-0800: 0.911: <span style=color:#f92672>[</span>weak refs processing, 0.0000367 secs<span style=color:#f92672>]</span>2020-10-28T21:29:26.789-0800: 0.911: <span style=color:#f92672>[</span>class unloading, 0.0002643 secs<span style=color:#f92672>]</span>2020-10-28T21:29:26.789-0800: 0.911: <span style=color:#f92672>[</span>scrub symbol table, 0.0004242 secs<span style=color:#f92672>]</span>2020-10-28T21:29:26.790-0800: 0.912: <span style=color:#f92672>[</span>scrub string table, 0.0002150 secs<span style=color:#f92672>][</span><span style=color:#ae81ff>1</span> CMS-remark: 447174K<span style=color:#f92672>(</span>699072K<span style=color:#f92672>)]</span> 482598K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0016199 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.01 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.790-0800: 0.912: <span style=color:#f92672>[</span>CMS-concurrent-sweep-start<span style=color:#f92672>]</span>
2020-10-28T21:29:26.791-0800: 0.913: <span style=color:#f92672>[</span>CMS-concurrent-sweep: 0.001/0.001 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.01 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.791-0800: 0.913: <span style=color:#f92672>[</span>CMS-concurrent-reset-start<span style=color:#f92672>]</span>
2020-10-28T21:29:26.795-0800: 0.917: <span style=color:#f92672>[</span>CMS-concurrent-reset: 0.004/0.004 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.853-0800: 0.975: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.853-0800: 0.975: <span style=color:#f92672>[</span>ParNew: 314560K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0353203 secs<span style=color:#f92672>]</span> 633375K-&gt;437839K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0354226 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.25 sys<span style=color:#f92672>=</span>0.01, real<span style=color:#f92672>=</span>0.03 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.944-0800: 1.066: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>Allocation Failure<span style=color:#f92672>)</span> 2020-10-28T21:29:26.944-0800: 1.066: <span style=color:#f92672>[</span>ParNew: 314559K-&gt;34943K<span style=color:#f92672>(</span>314560K<span style=color:#f92672>)</span>, 0.0477693 secs<span style=color:#f92672>]</span> 717455K-&gt;519710K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0478575 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.33 sys<span style=color:#f92672>=</span>0.02, real<span style=color:#f92672>=</span>0.05 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.992-0800: 1.114: <span style=color:#f92672>[</span>GC <span style=color:#f92672>(</span>CMS Initial Mark<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> CMS-initial-mark: 484766K<span style=color:#f92672>(</span>699072K<span style=color:#f92672>)]</span> 519782K<span style=color:#f92672>(</span>1013632K<span style=color:#f92672>)</span>, 0.0002269 secs<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Times: user<span style=color:#f92672>=</span>0.00 sys<span style=color:#f92672>=</span>0.00, real<span style=color:#f92672>=</span>0.00 secs<span style=color:#f92672>]</span>
2020-10-28T21:29:26.992-0800: 1.114: <span style=color:#f92672>[</span>CMS-concurrent-mark-start<span style=color:#f92672>]</span>
执行结束!共生成对象次数:8324
Heap
 par new generation   total 314560K, used 46300K <span style=color:#f92672>[</span>0x0000000780000000, 0x0000000795550000, 0x0000000795550000<span style=color:#f92672>)</span>
  eden space 279616K,   4% used <span style=color:#f92672>[</span>0x0000000780000000, 0x0000000780b17080, 0x0000000791110000<span style=color:#f92672>)</span>
  from space 34944K,  99% used <span style=color:#f92672>[</span>0x0000000791110000, 0x000000079332ffb8, 0x0000000793330000<span style=color:#f92672>)</span>
  to   space 34944K,   0% used <span style=color:#f92672>[</span>0x0000000793330000, 0x0000000793330000, 0x0000000795550000<span style=color:#f92672>)</span>
 concurrent mark-sweep generation total 699072K, used 484766K <span style=color:#f92672>[</span>0x0000000795550000, 0x00000007c0000000, 0x00000007c0000000<span style=color:#f92672>)</span>
 Metaspace       used 2695K, capacity 4486K, committed 4864K, reserved 1056768K
  class space    used 295K, capacity 386K, committed 512K, reserved 1048576K
</code></pre></div><p>年轻代GC次数减少</p>
<p>当堆内存配置增大到2G时，未发生Full GC</p>
<h4 id=233-cms-gc总结>2.3.3 CMS GC总结</h4>
<p>CMS GC对年轻代采用并行STW方式的标记-复制算法</p>
<p>对老年代主要采用并发-清除算法</p>
<p>CMS的设计目标是避免在老年代垃圾收集时出现长时间的卡顿，主要使用了以下手段</p>
<ul>
<li>不对老年代进行整理，使用空闲列表来管理内存空间的回收</li>
<li>在标记-清除阶段的大部分工作是和应用线程一起并发执行的，并没有明显的应用线程暂停，只是仍然会有默认约1/4的线程数被CMS使用，无法处理业务</li>
</ul>
<h3 id=24-g1-gc的演示>2.4 G1 GC的演示</h3>
<h4 id=241-使用512m堆内存>2.4.1 使用512m堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseG1GC -Xms512m -Xmx512m -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-28T21:57:25.232-0800: 0.113: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 30M-&gt;12M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0064043 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.251-0800: 0.132: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 42M-&gt;25M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0041272 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.281-0800: 0.163: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 76M-&gt;40M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0078441 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.371-0800: 0.253: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 207M-&gt;96M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0223950 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.411-0800: 0.292: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 166M-&gt;118M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0102596 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.467-0800: 0.349: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 240M-&gt;155M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0113187 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.538-0800: 0.419: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 332M-&gt;210M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0238433 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.575-0800: 0.456: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 263M-&gt;226M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0055120 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.580-0800: 0.461: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.580-0800: 0.462: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0002146 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.580-0800: 0.462: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.583-0800: 0.464: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0020412 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.583-0800: 0.464: <span style=color:#f92672>[</span>GC remark, 0.0016615 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.585-0800: 0.466: <span style=color:#f92672>[</span>GC cleanup 238M-&gt;238M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0007807 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.643-0800: 0.524: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span>-- 412M-&gt;322M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0225409 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.667-0800: 0.548: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 326M-&gt;302M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0047500 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.672-0800: 0.553: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 305M-&gt;304M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0010250 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.673-0800: 0.554: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.673-0800: 0.554: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0003432 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.673-0800: 0.554: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.676-0800: 0.557: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0023245 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.676-0800: 0.557: <span style=color:#f92672>[</span>GC remark, 0.0016252 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.677-0800: 0.559: <span style=color:#f92672>[</span>GC cleanup 311M-&gt;311M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0007358 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.702-0800: 0.583: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 413M-&gt;335M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0047817 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.713-0800: 0.595: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 354M-&gt;296M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0066535 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.727-0800: 0.608: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 321M-&gt;281M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0056230 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.733-0800: 0.615: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 285M-&gt;282M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0012278 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.735-0800: 0.616: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.735-0800: 0.616: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0001595 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.735-0800: 0.616: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.736-0800: 0.617: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0010456 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.736-0800: 0.617: <span style=color:#f92672>[</span>GC remark, 0.0013495 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.737-0800: 0.619: <span style=color:#f92672>[</span>GC cleanup 290M-&gt;290M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0006517 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.773-0800: 0.654: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 397M-&gt;309M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0088930 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.786-0800: 0.667: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 326M-&gt;285M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0071521 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.794-0800: 0.675: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 287M-&gt;285M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0020329 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.796-0800: 0.677: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.797-0800: 0.678: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0002620 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.797-0800: 0.678: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.798-0800: 0.680: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0018111 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.799-0800: 0.680: <span style=color:#f92672>[</span>GC remark, 0.0014714 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.800-0800: 0.681: <span style=color:#f92672>[</span>GC cleanup 290M-&gt;290M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0007712 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.843-0800: 0.724: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 410M-&gt;318M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0105067 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.857-0800: 0.738: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 332M-&gt;302M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0068699 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.864-0800: 0.745: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 303M-&gt;301M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0009557 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.865-0800: 0.746: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.865-0800: 0.746: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0001180 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.865-0800: 0.746: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.866-0800: 0.747: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0010210 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.866-0800: 0.748: <span style=color:#f92672>[</span>GC remark, 0.0012343 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.868-0800: 0.749: <span style=color:#f92672>[</span>GC cleanup 309M-&gt;309M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0006014 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.910-0800: 0.791: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span>-- 431M-&gt;373M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0093748 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.924-0800: 0.805: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 385M-&gt;352M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0129968 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.937-0800: 0.818: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 353M-&gt;352M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0016033 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.939-0800: 0.820: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.939-0800: 0.820: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0002198 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.939-0800: 0.820: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.941-0800: 0.822: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0024792 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.941-0800: 0.823: <span style=color:#f92672>[</span>GC remark, 0.0014409 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.943-0800: 0.824: <span style=color:#f92672>[</span>GC cleanup 358M-&gt;357M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0008914 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.944-0800: 0.825: <span style=color:#f92672>[</span>GC concurrent-cleanup-start<span style=color:#f92672>]</span>
2020-10-28T21:57:25.944-0800: 0.825: <span style=color:#f92672>[</span>GC concurrent-cleanup-end, 0.0000463 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.967-0800: 0.848: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 420M-&gt;365M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0081586 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.982-0800: 0.863: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 389M-&gt;332M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0077074 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:25.999-0800: 0.880: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 356M-&gt;321M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0088095 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.008-0800: 0.889: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 322M-&gt;321M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0019910 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.010-0800: 0.891: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.010-0800: 0.892: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0003347 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.010-0800: 0.892: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.012-0800: 0.893: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0018440 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.012-0800: 0.894: <span style=color:#f92672>[</span>GC remark, 0.0015711 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.014-0800: 0.895: <span style=color:#f92672>[</span>GC cleanup 328M-&gt;328M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0006491 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.047-0800: 0.929: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 421M-&gt;348M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0080509 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.059-0800: 0.941: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 364M-&gt;334M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0071440 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.067-0800: 0.948: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 335M-&gt;334M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0013653 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.068-0800: 0.950: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.069-0800: 0.950: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0001877 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.069-0800: 0.950: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.070-0800: 0.951: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0014384 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.070-0800: 0.951: <span style=color:#f92672>[</span>GC remark, 0.0015030 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.072-0800: 0.953: <span style=color:#f92672>[</span>GC cleanup 341M-&gt;341M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0006701 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.101-0800: 0.982: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 410M-&gt;356M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0057115 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.112-0800: 0.993: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 380M-&gt;337M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0064511 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.126-0800: 1.007: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 364M-&gt;339M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0054688 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.132-0800: 1.014: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 343M-&gt;342M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0015743 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.134-0800: 1.015: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.134-0800: 1.015: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0001497 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.134-0800: 1.015: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.136-0800: 1.017: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0015144 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.136-0800: 1.017: <span style=color:#f92672>[</span>GC remark, 0.0021530 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.138-0800: 1.020: <span style=color:#f92672>[</span>GC cleanup 349M-&gt;349M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0007141 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.151-0800: 1.032: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 410M-&gt;361M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0037391 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.163-0800: 1.044: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 383M-&gt;342M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0105066 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.179-0800: 1.060: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 368M-&gt;349M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0027737 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.182-0800: 1.063: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 351M-&gt;350M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0011975 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.183-0800: 1.064: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.183-0800: 1.064: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0000716 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.183-0800: 1.064: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T21:57:26.185-0800: 1.066: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0015372 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.185-0800: 1.066: <span style=color:#f92672>[</span>GC remark, 0.0015067 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.187-0800: 1.068: <span style=color:#f92672>[</span>GC cleanup 358M-&gt;358M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0007934 secs<span style=color:#f92672>]</span>
2020-10-28T21:57:26.204-0800: 1.085: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 407M-&gt;370M<span style=color:#f92672>(</span>512M<span style=color:#f92672>)</span>, 0.0032264 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:7336
</code></pre></div><ol>
<li>年轻代模式转移暂停</li>
<li>并发标记
<ul>
<li>Initial Mark 初始标记</li>
<li>Root Region Scan Root区扫描</li>
<li>Concurrent mark 并发标记</li>
<li>Remark 再次标记</li>
<li>Cleanup 清理</li>
</ul>
</li>
<li>转移暂停：混合模式</li>
</ol>
<h4 id=242-使用1g堆内存>2.4.2 使用1g堆内存</h4>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -XX:+UseG1GC -Xms1g -Xmx1g -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps GCLogAnalysis
正在执行...
2020-10-28T22:13:42.636-0800: 0.142: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 63M-&gt;22M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0066787 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:42.657-0800: 0.163: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 74M-&gt;38M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0072367 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:42.682-0800: 0.188: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 94M-&gt;59M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0103774 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:42.729-0800: 0.235: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 139M-&gt;87M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0179104 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:42.788-0800: 0.294: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 181M-&gt;113M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0136790 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.179-0800: 0.685: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span>-- 879M-&gt;620M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0193717 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.199-0800: 0.705: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 621M-&gt;619M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0054998 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.204-0800: 0.710: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.205-0800: 0.711: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0000656 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.205-0800: 0.711: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.210-0800: 0.716: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0055988 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.210-0800: 0.716: <span style=color:#f92672>[</span>GC remark, 0.0016491 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.212-0800: 0.718: <span style=color:#f92672>[</span>GC cleanup 643M-&gt;637M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0016012 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.214-0800: 0.720: <span style=color:#f92672>[</span>GC concurrent-cleanup-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.214-0800: 0.720: <span style=color:#f92672>[</span>GC concurrent-cleanup-end, 0.0000607 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.318-0800: 0.824: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span>-- 917M-&gt;804M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0068808 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.331-0800: 0.837: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 836M-&gt;711M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0053273 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.347-0800: 0.853: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 768M-&gt;636M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0055688 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.367-0800: 0.873: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 693M-&gt;568M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0098698 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.398-0800: 0.904: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 622M-&gt;517M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0103969 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.409-0800: 0.915: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Humongous Allocation<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>initial-mark<span style=color:#f92672>)</span> 519M-&gt;519M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0030924 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.413-0800: 0.919: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.413-0800: 0.919: <span style=color:#f92672>[</span>GC concurrent-root-region-scan-end, 0.0002625 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.413-0800: 0.919: <span style=color:#f92672>[</span>GC concurrent-mark-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.416-0800: 0.922: <span style=color:#f92672>[</span>GC concurrent-mark-end, 0.0033186 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.417-0800: 0.923: <span style=color:#f92672>[</span>GC remark, 0.0017304 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.419-0800: 0.925: <span style=color:#f92672>[</span>GC cleanup 529M-&gt;508M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0010501 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.420-0800: 0.926: <span style=color:#f92672>[</span>GC concurrent-cleanup-start<span style=color:#f92672>]</span>
2020-10-28T22:13:43.420-0800: 0.926: <span style=color:#f92672>[</span>GC concurrent-cleanup-end, 0.0000595 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.538-0800: 1.044: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>young<span style=color:#f92672>)</span> 831M-&gt;572M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0121038 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.554-0800: 1.060: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 592M-&gt;480M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0088458 secs<span style=color:#f92672>]</span>
2020-10-28T22:13:43.583-0800: 1.089: <span style=color:#f92672>[</span>GC pause <span style=color:#f92672>(</span>G1 Evacuation Pause<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>mixed<span style=color:#f92672>)</span> 541M-&gt;431M<span style=color:#f92672>(</span>1024M<span style=color:#f92672>)</span>, 0.0138395 secs<span style=color:#f92672>]</span>
执行结束!共生成对象次数:7381
</code></pre></div>
</div>
<footer class=post__footer>
<div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg>
<ul class=tags__list>
<li class=tags__item>
<a class="tags__link btn" href=/tags/java/ rel=tag>Java</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/gc/ rel=tag>GC</a>
</li>
<li class=tags__item>
<a class="tags__link btn" href=/tags/jvm/ rel=tag>JVM</a>
</li>
</ul>
</div>
</footer>
</article>
</main>
<div class="authorbox clearfix">
<figure class=authorbox__avatar>
<img alt="陈曦 avatar" src=/image/WechatIMG2.jpeg class=avatar height=90 width=90>
</figure>
<div class=authorbox__header>
<span class=authorbox__name>About 陈曦</span>
</div>
<div class=authorbox__description>
软件工程师
</div>
</div>
<nav class="pager flex">
<div class="pager__item pager__item--prev">
<a class=pager__link href=/posts/redis%E6%8C%81%E4%B9%85%E5%8C%96%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E8%B5%B0%E5%90%91%E9%AB%98%E5%8F%AF%E7%94%A8/ rel=prev>
<span class=pager__subtitle>«&#8201;Previous</span>
<p class=pager__title>Redis持久化、主从复制、哨兵、集群配置，一步一步走向高可用</p>
</a>
</div>
<div class="pager__item pager__item--next">
<a class=pager__link href=/posts/mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-%E5%BC%82%E6%AD%A5%E5%A4%8D%E5%88%B6/ rel=next>
<span class=pager__subtitle>Next&#8201;»</span>
<p class=pager__title>MySQL主从复制-异步复制</p>
</a>
</div>
</nav>
</div>
</div>
<footer class=footer>
<div class="container footer__container flex">
<div class=footer__copyright>
&copy; 2021 chenxi.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span>
</div>
</div>
</footer>
</div>
<script async defer src=/js/menu.js></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>